<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculator Pro Lite</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:Arial, sans-serif;background:linear-gradient(135deg,#0f172a,#1e293b);display:flex;justify-content:center;align-items:center;min-height:100dvh;}
.calculator{width:340px;max-width:95vw;background:#1e293b;padding:20px;border-radius:20px;box-shadow:0 15px 40px rgba(0,0,0,0.6);}
.display{background:#0f172a;padding:15px;border-radius:12px;margin-bottom:10px;min-height:70px;color:white;font-size:22px;word-break:break-word;}
.history-btn{font-size:13px;margin-bottom:8px;background:#334155;color:white;padding:6px;border:none;border-radius:6px;}
.buttons{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;}
button{padding:15px;border:none;border-radius:12px;font-size:18px;background:#334155;color:white;cursor:pointer;}
button:active{transform:scale(0.95);}
.operator{ background:#f97316; }
.equal{ background:#22c55e; grid-column:span 2; }
.zero{ grid-column:span 2; }
.history-panel{position:fixed;bottom:-100%;left:0;width:100%;height:60%;background:#0f172a;transition:0.3s;padding:15px;overflow-y:auto;}
.history-panel.active{bottom:0;}
.history-panel h3{color:white;margin-bottom:10px;}
.history-panel li{color:white;margin-bottom:8px;cursor:pointer;border-bottom:1px solid #334155;padding-bottom:5px;}
</style>
</head>

<body>
<div class="calculator">

  <div id="display" class="display">0</div>
  <button class="history-btn" onclick="toggleHistory()">History</button>

  <div class="buttons">
    <button onclick="clearDisplay()" class="operator">C</button>
    <button onclick="backspace()" class="operator">⌫</button>
    <button onclick="append('(')">(</button>
    <button onclick="append(')')">)</button>

    <button onclick="append('7')">7</button>
    <button onclick="append('8')">8</button>
    <button onclick="append('9')">9</button>
    <button onclick="append('÷')" class="operator">÷</button>

    <button onclick="append('4')">4</button>
    <button onclick="append('5')">5</button>
    <button onclick="append('6')">6</button>
    <button onclick="append('×')" class="operator">×</button>

    <button onclick="append('1')">1</button>
    <button onclick="append('2')">2</button>
    <button onclick="append('3')">3</button>
    <button onclick="append('−')" class="operator">−</button>

    <button onclick="append('0')" class="zero">0</button>
    <button onclick="append('.')">.</button>
    <button onclick="append('+')" class="operator">+</button>

    <button onclick="insertSqrt()">√</button>
    <button onclick="append('^')">xʸ</button>
    <button onclick="calculate()" class="equal">=</button>
  </div>
</div>

<!-- HISTORY -->
<div id="historyPanel" class="history-panel">
  <h3>History</h3>
  <ul id="historyList"></ul>
  <button onclick="clearHistory()" class="operator">Clear History</button>
</div>

<script>
let display=document.getElementById("display");
let historyPanel=document.getElementById("historyPanel");
let historyList=document.getElementById("historyList");
let historyArray=JSON.parse(localStorage.getItem("calcHistory"))||[];

/* APPEND */
function append(value){
  if(display.innerText==="0")
    display.innerText=value;
  else
    display.innerText+=value;
}

/* SQRT automatic */
function insertSqrt(){
  if(display.innerText==="0")
    display.innerText="√";
  else
    display.innerText+="√";
}

/* CLEAR */
function clearDisplay(){ display.innerText="0"; }

/* BACKSPACE */
function backspace(){ display.innerText=display.innerText.slice(0,-1) || "0"; }

/* CALCULATE - stress-free */
function calculate(){
  try{
    let exp = display.innerText;

    // Replace symbols with JS operators
    exp = exp.split("÷").join("/");
    exp = exp.split("×").join("*");
    exp = exp.split("−").join("-");
    exp = exp.split("^").join("**");

    // Convert √numbers automatically, e.g. √25 => Math.sqrt(25)
    exp = exp.replace(/√([0-9.]+)/g,"Math.sqrt($1)");

    // Evaluate using Function (safer than eval)
    let result = Function('"use strict"; return ('+exp+')')();

    addHistory(display.innerText + " = " + result);

    display.innerText = result;

  } catch {
    display.innerText = "Error";
  }
}

/* HISTORY */
function addHistory(entry){
  historyArray.unshift(entry);
  if(historyArray.length>50) historyArray.pop();
  localStorage.setItem("calcHistory",JSON.stringify(historyArray));
  renderHistory();
}

function renderHistory(){
  historyList.innerHTML="";
  historyArray.forEach(item=>{
    let li=document.createElement("li");
    li.innerText=item;
    li.onclick=function(){
      display.innerText=item.split("=")[0].trim();
      toggleHistory();
    };
    historyList.appendChild(li);
  });
}

function clearHistory(){
  historyArray=[];
  localStorage.removeItem("calcHistory");
  renderHistory();
}

function toggleHistory(){ historyPanel.classList.toggle("active"); }

/* LOAD HISTORY */
renderHistory();
</script>
</body>
</html>
