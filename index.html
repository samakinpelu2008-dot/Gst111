<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GOAT Awards 2024</title>
<style>
    body {
        margin:0;
        padding:0;
        font-family: Arial,sans-serif;
        background: linear-gradient(135deg,#1b1b1b,#3b0000);
        color:white;
        text-align:center;
    }
    h1{margin-top:20px;font-size:45px;text-shadow:2px 2px 10px red;}
    .container{width:95%;max-width:700px;margin:auto;margin-top:30px;}
    .player-box{
        background: rgba(255,255,255,0.1);
        padding:20px;
        margin:15px 0;
        border-radius:15px;
        backdrop-filter: blur(5px);
        position:relative;
    }
    .score{font-size:60px;font-weight:bold;margin:10px 0;transition: transform 0.2s ease;}
    .fire{font-size:30px;margin-top:5px;display:none;}
    button{padding:12px 25px;border:none;border-radius:8px;background:red;color:white;font-size:18px;cursor:pointer;margin-top:10px;}
    button:hover{background:darkred;}
    #commentSection{margin-top:40px;background:rgba(0,0,0,0.4);padding:20px;border-radius:12px;}
    .comment{
        background: rgba(255,255,255,0.1);
        padding: 10px;
        border-radius: 10px;
        margin: 10px 0;
        text-align:left;
    }
    .share-buttons{margin-top:30px;}
    .share-buttons button{margin:5px;}
    .notice{color:yellow;font-weight:bold;margin-top:10px;}
</style>
</head>
<body>

<h1>GOAT Awards 2024</h1>

<div class="container">
    <div class="player-box">
        <h2>Ronaldo</h2>
        <div id="ronaldo-score" class="score">0</div>
        <div id="ronaldo-fire" class="fire">ðŸ”¥ðŸ”¥ðŸ”¥</div>
        <button onclick="startVote('ronaldo')">Vote Ronaldo</button>
    </div>

    <div class="player-box">
        <h2>Messi</h2>
        <div id="messi-score" class="score">0</div>
        <div id="messi-fire" class="fire">ðŸ”¥ðŸ”¥ðŸ”¥</div>
        <button onclick="startVote('messi')">Vote Messi</button>
    </div>
</div>

<div id="commentSection" class="container">
    <h2>Comments</h2>
    <input id="commentInput" type="text" placeholder="Write a comment..." style="width:80%;padding:10px;border-radius:8px;">
    <button onclick="postComment()">Post</button>
    <div id="allComments"></div>
    <button onclick="loadMoreComments()" style="margin-top:10px;">View More Comments</button>
</div>

<div class="share-buttons container">
    <h2>Share & Invite Friends</h2>
    <button onclick="share('facebook')">Facebook</button>
    <button onclick="share('twitter')">Twitter</button>
    <button onclick="share('whatsapp')">WhatsApp</button>
    <button onclick="share('tiktok')">TikTok Follow</button>
    <div class="notice">Important: You may experience a redirect when voting. Click again and it will work!</div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import { getDatabase, ref, get, set, push, update, onValue } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";

const firebaseConfig = {
    apiKey: "AIzaSyAT9v-MfKjPpBHT58Iwt8JznDvwRjPIhqs",
    authDomain: "goat-awards.firebaseapp.com",
    databaseURL: "https://goat-awards-default-rtdb.firebaseio.com/",
    projectId: "goat-awards",
    storageBucket: "goat-awards.firebasestorage.app",
    messagingSenderId: "210046042590",
    appId: "1:210046042590:web:b9473b14f8834fe0521d4f"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

// Prevent multiple votes per session
let voted = sessionStorage.getItem('voted') || null;

// Redirect link before actual voting
const redirectLink = "https://obvioussecretive.com/rwj2iaik6g?key=d39bd78c2ae2358792721a701a778ba9";

function showRedirectNotice(){ alert("You are being redirected. Click again to vote!"); }

window.startVote = function(player){
    if(!voted){
        window.open(redirectLink,"_blank");
        showRedirectNotice();
        voted = player + "_redirected";
        sessionStorage.setItem('voted',voted);
    } else if(voted && voted.includes("_redirected")){
        vote(player);
        voted = player;
        sessionStorage.setItem('voted',voted);
        alert("Your vote has been counted for "+player+"!");
    } else { alert("You have already voted!"); }
};

// LIVE SCORES
function loadScores(){
    onValue(ref(db,"players"),snap=>{
        let data = snap.val() || {};
        let messi = data.messi ?? 0;
        let ronaldo = data.ronaldo ?? 0;

        document.getElementById("messi-score").innerText = messi;
        document.getElementById("ronaldo-score").innerText = ronaldo;

        animateScore("messi-score");
        animateScore("ronaldo-score");

        document.getElementById("messi-fire").style.display="none";
        document.getElementById("ronaldo-fire").style.display="none";
        if(messi>ronaldo) document.getElementById("messi-fire").style.display="block";
        else if(ronaldo>messi) document.getElementById("ronaldo-fire").style.display="block";
    });
}
loadScores();
function animateScore(id){const el=document.getElementById(id);el.style.transform="scale(1.3)";setTimeout(()=>el.style.transform="scale(1)",200);}
function vote(player){
    const playerRef = ref(db,"players/"+player);
    get(playerRef).then(snap=>{
        let score = snap.val()??0;
        update(ref(db,"players"),{[player]:score+1});
    });
}

// FAKE COMMENTS
let fakeUsers = [];
for(let i=1;i<=350;i++) fakeUsers.push("User"+Math.floor(Math.random()*3000000));

let fakeComments = [
    "CR7 forever! âš½ðŸ”¥","Messi is the real GOAT! ðŸ","Does Ronaldo even have a World Cup? ðŸ˜‚","Messi too short ðŸ™„","Ronaldo haters ðŸ˜Ž","Messi deserves it more","Ronaldo all day! ðŸ’ª","Messi magic âœ¨","Ronaldo fitness is insane","Messi no chance? ðŸ¤”",
    "Up Ronaldo, hands up! ðŸ™Œ","Messi is the king ðŸ‘‘","This is crazy! ðŸ˜±","I love both but Ronaldo ðŸ’¯","Messi haters ðŸ¤·â€â™‚ï¸","Ronaldo unstoppable","Messi skills unmatched","Ronaldo fans rise ðŸ”¥","Messi vs Ronaldo debate ðŸ—£ï¸","Who is your GOAT? ðŸ¤”"
];

let commentIndex = 0;
let loadedComments = 20;

function randomDate(start,end){
    return new Date(start.getTime() + Math.random()*(end.getTime()-start.getTime()));
}

function loadFakeComments(count){
    const container = document.getElementById("allComments");
    for(let i=0;i<count;i++){
        if(commentIndex>=fakeComments.length) commentIndex=0;
        let user = fakeUsers[Math.floor(Math.random()*fakeUsers.length)];
        let text = fakeComments[Math.floor(Math.random()*fakeComments.length)];
        let date = randomDate(new Date(2024,10,23),new Date()).toLocaleString();
        container.innerHTML+=`<div class="comment"><b>${user} - ${date}</b><br>${text}</div>`;
        commentIndex++;
    }
}

loadFakeComments(loadedComments);

window.loadMoreComments = function(){
    loadFakeComments(20);
};

// POST REAL COMMENTS
window.postComment=function(){
    const text=document.getElementById("commentInput").value.trim();
    if(!text) return;
    const commentRef=push(ref(db,"comments"));
    set(commentRef,{text:text,time:Date.now()});
    document.getElementById("commentInput").value="";
};

// REAL COMMENTS LOAD
onValue(ref(db,"comments"),snap=>{
    let container=document.getElementById("allComments");
    let data=snap.val()||{};
    let keys=Object.keys(data).reverse();
    keys.forEach(key=>{
        let c=data[key];
        let date=new Date(c.time).toLocaleString();
        container.innerHTML+=`<div class="comment"><b>RealUser - ${date}</b><br>${c.text}</div>`;
    });
});

// SHARE BUTTONS
window.share=function(platform){
    const url=window.location.href;
    if(platform==="facebook") window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}`,"_blank");
    else if(platform==="twitter") window.open(`https://twitter.com/intent/tweet?url=${url}&text=Vote now for your GOAT!`,"_blank");
    else if(platform==="whatsapp") window.open(`https://api.whatsapp.com/send?text=Vote now for your GOAT! ${url}`,"_blank");
    else if(platform==="tiktok") window.open(`https://www.tiktok.com/@prof.lord.peps?_r=1&_t=ZS-91yYLzVtT32`,"_blank");
};

// AUTO ADD NEW RANDOM COMMENT EVERY MINUTE
setInterval(()=>{loadFakeComments(10);},60000);

</script>
</body>
</html>
