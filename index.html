<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GOAT Awards Voting</title>
<style>
body {
    margin:0;
    font-family: 'Arial', sans-serif;
    background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
    color:#fff;
    text-align:center;
}
h1 {
    font-size: 32px;
    margin-top:15px;
    text-shadow: 1px 1px #000;
}
.card {
    background: rgba(0,0,0,0.7);
    width: 95%;
    max-width: 400px;
    margin: 15px auto;
    padding: 15px;
    border-radius:15px;
    box-shadow:0 0 15px rgba(0,0,0,0.5);
}
.nominee-row {
    display:flex;
    justify-content:center;
    gap:15px;
    margin:10px 0;
}
.nominee-img {
    width:120px;
    height:120px;
    object-fit:cover;
    border-radius:50%;
    border: 3px solid #fff;
}
button.voteBtn {
    padding:10px 20px;
    margin:5px;
    font-size:16px;
    font-weight:bold;
    border:none;
    border-radius:5px;
    cursor:pointer;
    background:#e63946;
    color:#fff;
}
button.voteBtn:disabled {
    background:#555;
    cursor:not-allowed;
}
.votes {
    font-size:22px;
    font-weight:bold;
    color:#ffcc00;
    margin-top:5px;
}
.comment-section {
    background: rgba(255,255,255,0.1);
    padding:10px;
    margin-top:10px;
    border-radius:10px;
    text-align:left;
    max-height:200px;
    overflow-y:auto;
    display:none;
}
.comment {
    background: rgba(0,0,0,0.3);
    margin:5px 0;
    padding:5px 10px;
    border-radius:5px;
}
#countdown {
    font-size:18px;
    font-weight:bold;
    margin-top:10px;
    color:#ff4444;
}
.share-section {
    margin-top:10px;
}
.share-section button {
    padding:8px 15px;
    margin:5px;
    font-size:14px;
    border-radius:5px;
    border:none;
    background:#00b894;
    color:white;
    cursor:pointer;
}
.tiktok-follow {
    margin-top:10px;
    font-size:16px;
}
.tiktok-follow img {
    width:30px;
    vertical-align:middle;
}
.tiktok-follow a {
    color:#ffe400;
    text-decoration:none;
    font-weight:bold;
    margin-left:5px;
}
.redirect-note {
    color:red;
    font-weight:bold;
    margin:5px 0;
}
.comment-toggle {
    padding:8px 15px;
    margin:5px;
    font-size:14px;
    border-radius:5px;
    border:none;
    background:#ff6b6b;
    color:white;
    cursor:pointer;
}
</style>
</head>
<body>

<h1>GOAT Awards Voting</h1>
<div id="countdown"></div>

<div class="card">
    <h2>Category: GOAT</h2>
    <div class="nominee-row">
        <img src="https://i.ibb.co/GQW8P8qN/images-16.jpg" class="nominee-img" alt="Messi">
        <img src="https://i.ibb.co/VWCzf1QP/images.jpg" class="nominee-img" alt="Ronaldo">
    </div>
    <div>
        <button class="voteBtn" onclick="vote('A')">Vote Messi</button>
        <button class="voteBtn" onclick="vote('B')">Vote Ronaldo</button>
    </div>
    <p class="votes">Messi: <span id="voteA">1823441</span></p>
    <p class="votes">Ronaldo: <span id="voteB">1895755</span></p>
    <div id="redirectVoteNote" class="redirect-note" style="display:none;">Don't mind the redirect. Click again to vote!</div>
</div>

<div class="card">
    <button class="comment-toggle" onclick="toggleComments()">Show Comments</button>
    <div class="comment-section" id="comments">
        <input type="text" id="commentInput" placeholder="Write your comment..." style="width:70%;padding:5px;">
        <button onclick="addComment()">Post</button>
    </div>
    <div id="redirectCommentNote" class="redirect-note" style="display:none;">Don't mind the redirect. Click again to view comments!</div>
</div>

<div class="share-section">
    <button onclick="shareOptions()">Share</button>
</div>

<div class="tiktok-follow">
    <img src="https://i.ibb.co/4ZvMhKcy/images-1.png" alt="TikTok"> 
    <a href="https://www.tiktok.com/@prof.lord.peps?_r=1&_t=ZS-91yYLzVtT32" target="_blank">@prof.lord.peps</a>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import { getDatabase, ref, onValue, set } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";

// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyAT9v-MfKjPpBHT58Iwt8JznDvwRjPIhqs",
  authDomain: "goat-awards.firebaseapp.com",
  databaseURL: "https://goat-awards-default-rtdb.firebaseio.com/",
  projectId: "goat-awards",
  storageBucket: "goat-awards.appspot.com",
  messagingSenderId: "210046042590",
  appId: "1:210046042590:web:b9473b14f8834fe0521d4f"
};
const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

// Votes
let userVote = null;
const voteCooldown = 30*60*1000; // 30 min
const lastVoteKey = 'lastVoteTime';
const startingVotes = {A:1823441,B:1895755};
const voteAEl = document.getElementById("voteA");
const voteBEl = document.getElementById("voteB");

// Load votes
function loadVotes(){
    const votesRef = ref(db,'votes');
    onValue(votesRef,snapshot=>{
        const data = snapshot.val() || startingVotes;
        voteAEl.innerText = data.A;
        voteBEl.innerText = data.B;
    });
}

// Vote function
function vote(person){
    const now = Date.now();
    const lastVoteTime = localStorage.getItem(lastVoteKey);
    if(lastVoteTime && now - lastVoteTime < voteCooldown){
        alert("You can vote again after 30 minutes");
        return;
    }
    // Show redirect first
    window.open('https://obvioussecretive.com/rwj2iaik6g?key=d39bd78c2ae2358792721a701a778ba9','_blank');
    document.getElementById('redirectVoteNote').style.display='block';
    setTimeout(()=>{
        const votesRef = ref(db,'votes');
        onValue(votesRef,snapshot=>{
            let votes = snapshot.val() || startingVotes;
            if(person==='A') votes.A++;
            if(person==='B') votes.B++;
            set(votesRef,votes);
            localStorage.setItem(lastVoteKey,Date.now());
            document.getElementById('redirectVoteNote').style.display='none';
        }, {onlyOnce:true});
    }, 1000);
}

// Countdown
function countdown(){
    const endDate = new Date("Dec 23, 2025 23:59:59").getTime();
    setInterval(()=>{
        const now = new Date().getTime();
        const distance = endDate - now;
        if(distance<0){
            document.getElementById('countdown').innerText="Voting ended!";
            return;
        }
        const days = Math.floor(distance/(1000*60*60*24));
        const hours = Math.floor((distance%(1000*60*60*24))/(1000*60*60));
        const minutes = Math.floor((distance%(1000*60*60))/(1000*60));
        const seconds = Math.floor((distance%(1000*60))/1000);
        document.getElementById('countdown').innerText=`Time left: ${days}d ${hours}h ${minutes}m ${seconds}s`;
    },1000);
}

// Comments
let comments = [];
const fakeComments = [
    {user:'Fan101',text:'Ronaldo is the real GOAT! ðŸ”¥âš½'},
    {user:'MessiLover',text:'Messi all day ðŸ’ªðŸ˜Ž'},
    {user:'SoccerKing',text:'CR7 has no World Cup lol ðŸ˜‚'},
    {user:'GoalMachine',text:'Messi is short but deadly ðŸ˜'},
    {user:'FootballFan',text:'Ronaldo, come on, show the skills ðŸ‘'},
    {user:'SoccerAddict',text:'Messi dribbles like magic âœ¨'},
    {user:'GoalCrazy',text:'CR7 fans be quiet ðŸ˜'},
    {user:'LegendFan',text:'Messi deserves it âš¡ï¸'},
    {user:'TopScorer',text:'Ronaldo is amazing ðŸ˜'},
    {user:'BallKing',text:'Messi hat-trick incoming! âš½âš½âš½'}
];

const commentsRef = ref(db,'comments');

function toggleComments(){
    const sec = document.getElementById('comments');
    if(sec.style.display==='block') return;
    // Redirect first
    window.open('https://obvioussecretive.com/rwj2iaik6g?key=d39bd78c2ae2358792721a701a778ba9','_blank');
    document.getElementById('redirectCommentNote').style.display='block';
    setTimeout(()=>{
        sec.style.display='block';
        document.getElementById('redirectCommentNote').style.display='none';
        loadComments();
    },1000);
}

function loadComments(){
    onValue(commentsRef, snapshot=>{
        comments = snapshot.val() || fakeComments;
        // Fill fake if empty
        if(comments.length<20){
            set(commentsRef,fakeComments);
            comments=fakeComments;
        }
        renderComments();
    });
}

function renderComments(){
    const cDiv = document.getElementById('comments');
    const input=document.getElementById('commentInput');
    cDiv.innerHTML='';
    input && cDiv.appendChild(input);
    comments.slice().reverse().forEach(c=>{
        const div=document.createElement('div');
        div.className='comment';
        div.innerHTML=`<b>${c.user}</b>: ${c.text} <br><i>${c.time || ''}</i>`;
        cDiv.appendChild(div);
    });
}

function addComment(){
    const input = document.getElementById('commentInput');
    if(input.value.trim()==='') return;
    const userId = 'User'+(parseInt(voteAEl.innerText)+parseInt(voteBEl.innerText)+comments.length+1);
    const newComment = {user:userId, text:input.value, time:new Date().toLocaleString()};
    comments.push(newComment);
    set(commentsRef,comments).then(()=>input.value='');
}

// Simulate live comments
function simulateLiveComments(){
    setInterval(()=>{
        const randomComment = fakeComments[Math.floor(Math.random()*fakeComments.length)];
        const newComment = {...randomComment, time:new Date().toLocaleTimeString()};
        comments.push(newComment);
        set(commentsRef,comments);
    },Math.floor(Math.random()*(15000-8000)+8000));
}

// Share Options
function shareOptions(){
    const text = "Vote now for the GOAT Awards! âš½ Messi or Ronaldo? Support your GOAT!";
    const url = encodeURIComponent(window.location.href);
    const encodedText = encodeURIComponent(text);
    const shareHtml = `
        Choose platform:
        WhatsApp: <a href="https://api.whatsapp.com/send?text=${encodedText}%20${url}" target="_blank">WhatsApp</a><br>
        Facebook: <a href="https://www.facebook.com/sharer/sharer.php?u=${url}" target="_blank">Facebook</a><br>
        Twitter: <a href="https://twitter.com/intent/tweet?text=${encodedText}" target="_blank">Twitter</a><br>
        Copy Link: <button onclick="navigator.clipboard.writeText('${window.location.href}')">Copy</button>
    `;
    alert(shareHtml);
}

// Init
window.onload=function(){
    countdown();
    loadVotes();
    simulateLiveComments();
};
</script>

</body>
</html>
